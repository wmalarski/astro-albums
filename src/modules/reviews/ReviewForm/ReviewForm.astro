---
import { AlertIcon } from "@components/Alert/Alert";
import { Alert } from "@components/Alert/Alert";
import {
  TextFieldInput,
  TextFieldLabel,
  TextFieldLabelText,
  TextFieldRoot,
} from "@components/TextField/TextField";
import { Show } from "solid-js";

export type Props = {
  action: string;
  initialText?: string;
  initialRate?: number;
  formId: string;
  albumId: string;
  error?: string;
  errors?: Record<string, string>;
};

const { action, initialRate, initialText, formId, albumId, error, errors } =
  Astro.props;
---

<form class="w-full flex flex-col gap-2" id={formId} method="post">
  <input type="hidden" name="action" value={action} />
  <input type="hidden" name="albumId" value={albumId} />
  <Show when={error}>
    <Alert variant="error">
      <AlertIcon variant="error">
        {errors}
      </AlertIcon>
    </Alert>
  </Show>
  <TextFieldRoot>
    <TextFieldLabel for="review">
      <TextFieldLabelText>Review:</TextFieldLabelText>
    </TextFieldLabel>
    <TextFieldInput
      size="sm"
      id="review"
      name="text"
      placeholder="Review"
      type="text"
      value={initialText ?? ""}
      variant="bordered"
    />
    <Show when={errors?.text}>
      <Alert>
        <AlertIcon variant="error">
          {errors?.text}
        </AlertIcon>
      </Alert>
    </Show>
    <TextFieldRoot>
      <TextFieldLabel for="rate">
        <TextFieldLabelText>Rate:</TextFieldLabelText>
      </TextFieldLabel>
      <TextFieldInput
        size="sm"
        id="rate"
        name="rate"
        max={10}
        min={0}
        placeholder="Rate"
        step={0.1}
        type="number"
        value={initialRate ?? 5}
        variant="bordered"
      />
      <Show when={errors?.rate}>
        <Alert variant="error">
          <AlertIcon variant="error">
            {errors?.rate}
          </AlertIcon>
        </Alert>
      </Show>
    </TextFieldRoot>
  </TextFieldRoot>
</form>
